## Client

Клиент для работы с потоками данных.

### Установка

```bash
go get -u github.com/GDVFox/gostreaming/gostreaming/.../
```

### Команды

Любой вызов имеет вид:

```bash
gostreaming <meta_node_host>:<meta_node_port> CATEGORY COMMAND [OPTIONS]
```

#### Schemas

При задании CATEGORY `schemas` доступен следующий набор команд:

##### List

Возвращает список зарегистрированных действий.

Пример:

```bash
gostreaming 127.0.0.1:5555 schemas list
```

При этом отображается статус схемы.

##### Get

Возвращает описание указанной схемы. Описание схемы представлено [тут](#описание-схемы).

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя загружаемой схемы* |
| `-f, --format` | yaml | формат вывода, возможные значения: json, yaml. |
| `-o, --out` |  | файл, в который будет записана схема |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 schemas get -n simplepipe -f json -o simplepipe.json
```

##### New

Загружает новую схему. Описание схемы представлено [тут](#описание-схемы).

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-f, --file` |  | *файл со схемой в формате json или yaml* |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 schemas new -f examples/simplepipe/simplepipe.yaml
```

##### RM

Удаляет указанную схему.

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя схемы для удаления* |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 schemas rm -n simplepipe
```

##### Run

Запускает указанную схему с использованием сохраненного описания.

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя схемы для запуска* |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 schemas run -n simplepipe
```

##### Stop

Останавливает указанную схему.

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя схемы для запуска* |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 schemas stop -n simplepipe
```

#### Actions

При задании CATEGORY `actions` доступен следующий набор команд:

##### List

Возвращает список сохраненных действий.

Пример:

```bash
gostreaming 127.0.0.1:5555 actions list
```

##### Get

Возвращает бинарный файл, который был загружен ранее как действие.

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя загружаемого действия* |
| `-o, --out` |  | файл, в который будет записано действие |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 actions get -n printer -o printer
```

##### New

Загружает новое действие.

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя нового действия* |
| `-f, --file` |  | *бинарный файл с действием* |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 actions new -n filter -f _staff/bin/filter
```

##### RM

Удаляет указанное действие.

Флаги, описание обязательных флагов *выделено*:

| Опция   | По умолчанию | Описание |
|---------|--------------|----------|
| `-n, --name` |  | *имя действия для удаления* |
| `-h, --help` |  | выводит сообщение с помощью по команде |

Пример:

```bash
gostreaming 127.0.0.1:5555 actions rm -n printer
```

#### Help

При задании CATEGORY `help` выводится сообщение с помощью по команде.

#### About

При задании CATEGORY `about` выводится информация о клиенте gostreaming.

### Описание схемы

Представлено в формате yaml, в формате json все названия и ограничения аналогичны.

```yaml
# Имя схемы, должно быть уникально, среди всех схем, загруженных в meta_node.
name: simplepipe
# Список узлов графа потока данных.
nodes:
      # Уникальное имя узла, должно содержать только латинские буквы и цифры.
    - name: numgen
      # Название действия, которое предварительно загружено в meta_node.
      action: num_gen
      # Список адресов узла, по умолчанию действие запускается на первом адресе, в случае отказа, узел поднимается на следующем адресе и так далее.
      addresses:
          # Хост сервера, на котором необходимо запускать действие, на этом сервере должна работать machine_node.
        - host: 127.0.0.1
          # Порт действия, данный порт будет использоваться для связи действий между собой и не должен повторяться в пределах одного сервера.
          port: 9191
      # Список аргументов командной строки, которые будут переданы действию.
      args:
        - --freq=100
      # Список переменных окружения, которые будут переданы действию в формате KEY: Value.
      env:
        SECRET_KEY: please
# Описание схемы в виде алгебраического выражения.
dataflow: numgen ; printer
```
